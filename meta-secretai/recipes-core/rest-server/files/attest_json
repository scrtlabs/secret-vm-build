#!/bin/bash

# Execute the command and save its output
output=$(sudo ./attest_tool attest "$1" 2>&1)

# Get the current timestamp
timestamp=$(date -u +"%Y-%m-%dT%H:%M:%SZ")

# Check the return code of the command
if [ $? -eq 0 ]; then
    # If successful, print JSON with results
    echo "{\"status\": \"success\", \"input_data\": \"$1\", \"attestation\": \"$output\", \"timestamp\": \"$timestamp\"}"
    exit 0
else
    # If there is an error, print JSON with the error message
    echo "{\"status\": \"error\", \"message\": \"$output\", \"timestamp\": \"$timestamp\"}"
    exit 1
fi

